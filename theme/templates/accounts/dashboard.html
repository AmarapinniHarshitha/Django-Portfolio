{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard - Harshitha Amarapinni{% endblock %}

{% block content %}
<!-- Dashboard Header with Welcome Message -->
<section class="pt-24 pb-8 px-6">
    <div class="container mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-center bg-gray-800/30 rounded-2xl p-6 backdrop-blur-sm">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold">
                    Welcome back, <span class="text-blue-400">{{ user.username }}</span>
                </h1>
                <p class="text-gray-400 mt-1">Manage your portfolio and track your progress</p>
            </div>
            <div class="mt-4 md:mt-0">
                <span class="px-5 py-2 bg-green-600/20 text-green-400 rounded-full text-sm font-medium flex items-center">
                    <span class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></span>
                    Last active: {% now "F j, Y" %}
                </span>
            </div>
        </div>
    </div>
</section>

<!-- Stats Cards - REMOVED Total Views and Unread Messages, kept only project stats -->
<section class="py-4 px-6">
    <div class="container mx-auto">
        <div class="grid grid-cols-2 md:grid-cols-2 gap-4 mb-6 max-w-2xl mx-auto">
            <div class="bg-gray-800/40 backdrop-blur-sm rounded-xl p-4 border border-gray-700/50">
                <p class="text-gray-400 text-sm">Total Projects</p>
                <p class="text-3xl font-bold text-blue-400">{{ total_projects }}</p>
            </div>
            <div class="bg-gray-800/40 backdrop-blur-sm rounded-xl p-4 border border-gray-700/50">
                <p class="text-gray-400 text-sm">Active Projects</p>
                <p class="text-3xl font-bold text-green-400">{{ active_projects }}</p>
            </div>
        </div>
    </div>
</section>

<!-- Main Dashboard Content -->
<section class="py-4 px-6">
    <div class="container mx-auto">
        <div class="grid lg:grid-cols-3 gap-6">
            <!-- Left Column - Main Content -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Activity Timeline -->
                <div class="bg-gray-800/40 backdrop-blur-sm rounded-xl p-6 border border-gray-700/50">
                    <h2 class="text-lg font-semibold mb-6 text-gray-300 flex items-center">
                        <span class="w-1 h-5 bg-purple-500 rounded-full mr-3"></span>
                        Recent Activity
                    </h2>
                    
                    <div class="space-y-5">
                        {% for activity in recent_activity %}
                        <div class="flex items-start space-x-3">
                            <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                            <div class="flex-1">
                                <p class="text-sm font-medium">Project "{{ activity.title }}" was updated</p>
                                <p class="text-xs text-gray-500">{{ activity.updated_at|timesince }} ago</p>
                            </div>
                        </div>
                        {% empty %}
                        <p class="text-gray-500 text-center py-4">No recent activity</p>
                        {% endfor %}
                    </div>
                </div>

                <!-- Projects Preview -->
                <div class="bg-gray-800/40 backdrop-blur-sm rounded-xl p-6 border border-gray-700/50">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold text-gray-300 flex items-center">
                            <span class="w-1 h-5 bg-pink-500 rounded-full mr-3"></span>
                            Manage Projects
                        </h2>
                        <span class="text-2xl font-bold text-blue-400">{{ total_projects }}</span>
                    </div>
                    
                    <div class="space-y-3">
                        {% for project in recent_projects %}
                        <div class="flex items-center justify-between p-3 bg-gray-700/20 rounded-lg hover:bg-gray-700/30 transition">
                            <div class="flex items-center space-x-3">
                                <span class="text-xl">
                                    {% if forloop.counter == 1 %}ü§ñ
                                    {% elif forloop.counter == 2 %}üöó
                                    {% elif forloop.counter == 3 %}üíæ
                                    {% else %}üìÅ
                                    {% endif %}
                                </span>
                                <div>
                                    <p class="font-sm font-medium">{{ project.title|truncatechars:20 }}</p>
                                    <p class="text-xs text-gray-500">{{ project.views }} views</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 {% if project.status == 'active' %}bg-green-600/20 text-green-400{% elif project.status == 'draft' %}bg-yellow-600/20 text-yellow-400{% else %}bg-gray-600/20 text-gray-400{% endif %} text-xs rounded-full capitalize">
                                {{ project.status }}
                            </span>
                        </div>
                        {% empty %}
                        <p class="text-gray-500 text-center py-4">No projects yet. Create your first project!</p>
                        {% endfor %}
                    </div>
                    
                    <a href="{% url 'project-create' %}" class="mt-4 w-full py-3 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white font-semibold rounded-lg text-sm transition block text-center shadow-lg hover:shadow-blue-500/25">
                        + Add New Project
                    </a>
                </div>
            </div>

            <!-- Right Column - Profile Only (Skills and Most Viewed removed) -->
            <div class="space-y-6">
                <!-- Profile Card -->
                <div class="bg-gray-800/40 backdrop-blur-sm rounded-xl p-6 border border-gray-700/50 text-center">
                    <div class="relative inline-block mb-4">
                        <img src="{% static 'images/HarshithaPhoto.jpeg' %}" alt="Harshitha" 
                             class="w-24 h-24 rounded-full mx-auto border-3 border-blue-500 object-cover">
                        <span class="absolute bottom-1 right-1 w-3.5 h-3.5 bg-green-500 rounded-full border-2 border-gray-800"></span>
                    </div>
                    
                    <h3 class="text-xl font-bold">{{ user.username }}</h3>
                    <p class="text-sm text-gray-400 mb-4">Cybersecurity Enthusiast</p>
                    
                    <div class="flex justify-center space-x-4 mb-5">
                        <a href="https://github.com/AmarapinniHarshitha" target="_blank" class="text-gray-500 hover:text-blue-400 transition text-lg">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://linkedin.com/in/amarapinniharshitha" target="_blank" class="text-gray-500 hover:text-blue-400 transition text-lg">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="#" class="text-gray-500 hover:text-blue-400 transition text-lg">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </div>
                    
                    <a href="{% url 'project-list' %}" class="w-full py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm font-medium transition block">
                        Manage Projects
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Admin Controls (for Superuser) -->
{% if user.is_superuser %}
<section class="py-4 px-6">
    <div class="container mx-auto">
        <div class="bg-gray-800/40 backdrop-blur-sm rounded-xl p-6 border border-gray-700/50">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-lg font-semibold text-gray-300 flex items-center">
                    <span class="w-1 h-5 bg-red-500 rounded-full mr-3"></span>
                    Admin Controls
                </h2>
                <span class="px-2 py-1 bg-red-600/20 text-red-400 text-xs rounded-full">Superuser</span>
            </div>
            
            <div class="grid md:grid-cols-3 gap-3">
                <a href="/admin" target="_blank" class="bg-gray-700/30 hover:bg-gray-700/50 rounded-lg p-4 text-center transition group">
                    <div class="text-2xl mb-2 text-gray-400 group-hover:scale-110 transition-transform">‚öôÔ∏è</div>
                    <p class="text-xs text-gray-400">Django Admin</p>
                </a>
                
                <a href="{% url 'project-list' %}" class="bg-gray-700/30 hover:bg-gray-700/50 rounded-lg p-4 text-center transition group">
                    <div class="text-2xl mb-2 text-gray-400 group-hover:scale-110 transition-transform">üìù</div>
                    <p class="text-xs text-gray-400">Manage Projects</p>
                </a>
                
                <a href="/admin/auth/user/" target="_blank" class="bg-gray-700/30 hover:bg-gray-700/50 rounded-lg p-4 text-center transition group">
                    <div class="text-2xl mb-2 text-gray-400 group-hover:scale-110 transition-transform">üë•</div>
                    <p class="text-xs text-gray-400">Manage Users</p>
                </a>
            </div>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}